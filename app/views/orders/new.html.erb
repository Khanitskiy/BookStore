<h1><%= t(:title_cart) %></h1>
<% unless @books.empty? %>
<div class="row cart full_cart">
  <div class="col-md-12">
    <table class="table">
      <thead>
        <tr>
          <td>BOOK</td>
          <td>PRICE</td>
          <td>QTY</td>
          <td>TOTAL</td>
        </tr>
      </thead>
      <tbody>
        <% @books.try(:each) do |book| %>
          <tr class="tr">
            <td>
              <%= link_to "#{image_tag book.image_url :resize_to_cart} #{book.title}".html_safe, book %>
            </td>
            <td class="book_price"><%= number_to_currency(book.price) %></td>
            <td class="count">
              <input type="number" max="100" min="1" class="quantity-input" value="<%= items_calc(book, true) %>" id="quantity_<%= book.id %>" name="quantity-input">
            </td>
            <td class="total"><%= items_calc(book) %></td>
            <td class="remove_link">
              <%= link_to "<span aria-hidden='true'>&times;</span>".html_safe , 'javascript:void(0)', id: "id_" << book.id.to_s  %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <div class="col-md-6 col-md-offset-6 clearfix order-summary-block">
    <div class="order-summary-line">
      SUBTOTAL: <span><%= number_to_currency(@subtotal) %></span>
    </div>
  </div>
  <div class="col-md-6">
    <% if current_user %>
    <%= button_to "Empty cart", @order, :method => "delete", :class => "btn btn-default",  data: { confirm: "Are you sure?" } %>
    <% else %>
    <%= link_to "Empty cart", clear_shopcart_path, :class => "btn btn-default",  data: { confirm: "Are you sure?" } %>
    <% end %>
    <%= link_to "Continue shopping", books_path, :class => "btn btn-primary" %>
  </div>
  <div class="col-md-6 right-btns">
   
    <%= form_tag(order_steps_path, method: "get") do %>
      <% if defined?(@order) && @order.cupon.nil? %>
        <%= text_field_tag("cupon", nil, options = {class: 'cupon', placeholder: "Cupon code"} ) %>
      <% end %>
      <a href="<%= order_steps_path %>" id="checkout" class="btn btn-success pull-right checkout-btn">Checkout</a>
      <input type="button" class="btn btn-default pull-right" value="Update" id="update" name="commit">
    <% end %>
  </div>
</div>
<% end %>
<div class="cart_empty" <%= 'hidden' unless @books.empty? %>>
  <h4>Your shop cart is empty</h4>
</div>